<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>MSFT Swing — Risk Profiles Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Instrument+Serif:ital@0;1&family=Syne:wght@500;700;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root{
  --bg:#07090f; --s1:#0d1018; --s2:#121620; --s3:#191e2c;
  --bdr:#1e2535; --bdr2:#28304a;
  --g:#00d4aa; --b:#4f8ef7; --y:#f7c948; --r:#f75c5c;
  --tx:#d8e2f5; --mu:#5a6480;
  --ff:'Syne',sans-serif; --fi:'Instrument Serif',serif; --fm:'DM Mono',monospace;
  --cons:#4f8ef7; --bal:#f7c948; --agg:#00d4aa;
}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--tx);font-family:var(--ff);min-height:100vh}
body::before{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background:
    radial-gradient(ellipse 1000px 600px at 0% 0%,rgba(0,212,170,.055),transparent),
    radial-gradient(ellipse 800px 500px at 100% 100%,rgba(79,142,247,.045),transparent),
    linear-gradient(rgba(255,255,255,.008) 1px,transparent 1px) 0 0 / 52px 52px,
    linear-gradient(90deg,rgba(255,255,255,.008) 1px,transparent 1px) 0 0 / 52px 52px;
}
.w{position:relative;z-index:1;max-width:1460px;margin:0 auto;padding:0 28px 80px}

/* ─ HEADER ─ */
.hdr{padding:44px 0 32px;border-bottom:1px solid var(--bdr);margin-bottom:32px;
  display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:20px}
h1{font-size:2.8rem;font-weight:800;letter-spacing:-.035em;line-height:1}
h1 i{font-style:italic;font-family:var(--fi);color:var(--g);font-weight:400}
.hdr-sub{font-family:var(--fm);font-size:.7rem;color:var(--mu);margin-top:8px;line-height:1.8}
.pills{display:flex;gap:8px;flex-wrap:wrap}
.pill{font-family:var(--fm);font-size:.68rem;padding:4px 12px;border-radius:20px;
  border:1px solid var(--bdr);background:var(--s2);color:var(--mu)}
.pill.hi{border-color:rgba(0,212,170,.3);color:var(--g);background:rgba(0,212,170,.07)}

/* ─ PROFILE TABS ─ */
.tabs{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:28px}
.tab{border-radius:12px;border:2px solid var(--bdr);background:var(--s1);
  padding:20px 22px;cursor:pointer;transition:all .2s;position:relative;overflow:hidden}
.tab::before{content:'';position:absolute;bottom:0;left:0;right:0;height:3px;
  background:var(--tc,var(--g));border-radius:0 0 10px 10px}
.tab.active{border-color:var(--tc,var(--g));background:rgba(0,212,170,.04)}
.tab:hover{border-color:var(--tc)}
.tab-label{font-size:.65rem;text-transform:uppercase;letter-spacing:.14em;color:var(--mu);margin-bottom:8px;font-family:var(--fm)}
.tab-cagr{font-size:2.2rem;font-weight:800;color:var(--tc,var(--g));line-height:1;letter-spacing:-.03em}
.tab-mdd{font-family:var(--fm);font-size:.8rem;color:var(--mu);margin-top:6px}
.tab-risk{font-family:var(--fm);font-size:.7rem;margin-top:4px}

/* ─ KPI ROW ─ */
.kpi-row{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;margin-bottom:24px}
@media(max-width:1100px){.kpi-row{grid-template-columns:repeat(4,1fr)}}
@media(max-width:600px){.kpi-row{grid-template-columns:repeat(2,1fr)}}
.kpi{border-radius:10px;padding:14px 15px;border:1px solid var(--bdr);background:var(--s1);
  transition:border-color .15s}
.kpi.ok {border-color:rgba(0,212,170,.25);background:rgba(0,212,170,.03)}
.kpi.warn{border-color:rgba(247,201,72,.25);background:rgba(247,201,72,.03)}
.kpi-l{font-family:var(--fm);font-size:.62rem;text-transform:uppercase;letter-spacing:.1em;
  color:var(--mu);margin-bottom:6px}
.kpi-v{font-family:var(--fm);font-size:1.4rem;font-weight:500;line-height:1;
  color:var(--g)}.kpi.warn .kpi-v{color:var(--y)}
.kpi-t{font-family:var(--fm);font-size:.63rem;color:var(--mu);margin-top:4px}

/* ─ CHART GRID ─ */
.cg1{display:grid;grid-template-columns:2fr 1fr;gap:14px;margin-bottom:14px}
.cg2{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin-bottom:20px}
@media(max-width:900px){.cg1,.cg2{grid-template-columns:1fr}}
.card{background:var(--s1);border:1px solid var(--bdr);border-radius:12px;padding:20px 22px}
.ch{font-family:var(--fm);font-size:.62rem;text-transform:uppercase;letter-spacing:.12em;
  color:var(--mu);display:flex;align-items:center;gap:8px;margin-bottom:14px}
.ch-dot{width:6px;height:6px;border-radius:50%;background:var(--g);flex-shrink:0}
canvas{max-height:220px}

/* ─ SCATTER CARD ─ */
.scatter-card{background:var(--s1);border:1px solid var(--bdr);border-radius:12px;
  padding:20px 22px;margin-bottom:20px}

/* ─ BOTTOM GRID ─ */
.bot{display:grid;grid-template-columns:1fr 1.2fr 1.2fr;gap:14px;margin-bottom:20px}
@media(max-width:1000px){.bot{grid-template-columns:1fr 1fr}}
@media(max-width:640px){.bot{grid-template-columns:1fr}}

/* ─ TABLES ─ */
table{width:100%;border-collapse:collapse;font-size:.78rem}
th{padding:6px 9px;font-family:var(--fm);font-size:.6rem;text-transform:uppercase;
  letter-spacing:.1em;color:var(--mu);border-bottom:1px solid var(--bdr);text-align:left}
td{padding:8px 9px;border-bottom:1px solid rgba(255,255,255,.03)}
tr:last-child td{border-bottom:none}
tr:hover td{background:rgba(255,255,255,.012)}
.mono{font-family:var(--fm)}.sm{font-size:.71rem}.muted{color:var(--mu)}

/* ─ TAGS ─ */
.tag{display:inline-block;padding:2px 8px;border-radius:4px;
  font-family:var(--fm);font-size:.66rem;letter-spacing:.03em}
.tag-tf {background:rgba(0,212,170,.14);color:#00d4aa}
.tag-cp {background:rgba(79,142,247,.14);color:#4f8ef7}
.tag-mom{background:rgba(247,201,72,.14);color:#f7c948}
.tag-mr {background:rgba(247,92,92,.14);color:#f75c5c}

/* ─ YEARLY HEATMAP ─ */
.hy{display:grid;grid-template-columns:repeat(7,1fr);gap:7px;margin-top:10px}
@media(max-width:800px){.hy{grid-template-columns:repeat(4,1fr)}}
.hy-cell{border-radius:7px;border:1px solid;padding:9px 10px;text-align:center}
.hy-yr{font-family:var(--fm);font-size:.62rem;color:var(--mu);margin-bottom:3px}
.hy-val{font-family:var(--fm);font-size:.82rem;font-weight:500}

/* ─ RISK SLIDER ─ */
.slider-row{display:flex;align-items:center;gap:16px;margin-bottom:20px;flex-wrap:wrap}
.slider-row label{font-family:var(--fm);font-size:.72rem;color:var(--mu);white-space:nowrap}
input[type=range]{flex:1;min-width:200px;accent-color:var(--g)}
.slider-val{font-family:var(--fm);font-size:.9rem;color:var(--g);min-width:50px}

/* ─ DISCLAIMER ─ */
.disc{background:var(--s2);border:1px solid var(--bdr);border-radius:8px;
  padding:12px 18px;font-size:.7rem;color:var(--mu);line-height:1.65;margin-top:12px}

/* ─ ANIM ─ */
@keyframes up{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}
.kpi{animation:up .28s ease both}
.kpi:nth-child(1){animation-delay:.03s}.kpi:nth-child(2){animation-delay:.06s}
.kpi:nth-child(3){animation-delay:.09s}.kpi:nth-child(4){animation-delay:.12s}
.kpi:nth-child(5){animation-delay:.15s}.kpi:nth-child(6){animation-delay:.18s}
.kpi:nth-child(7){animation-delay:.21s}
</style>
</head>
<body>
<div class="w">

<!-- HEADER -->
<div class="hdr">
  <div>
    <h1>MSFT Swing System<br><i>Risk Profiles Dashboard</i></h1>
    <div class="hdr-sub">
      Daily 1D · 2013–2026 · 13 anni · Walk-forward no-lookahead<br>
      Sharpe/Sortino: daily returns inclusi flat × √252 · 3 profili di rischio confrontati
    </div>
  </div>
  <div class="pills">
    <span class="pill hi">✓ Sharpe corretto</span>
    <span class="pill hi">✓ DD 13–20% target</span>
    <span class="pill">CAGR lineare col rischio</span>
    <span class="pill">n=213 trade / 13 anni</span>
  </div>
</div>

<!-- PROFILE SELECTOR TABS -->
<div class="tabs">
  <div class="tab active" id="tab-cons" style="--tc:var(--cons)" onclick="setProfile('cons')">
    <div class="tab-label">Conservativo</div>
    <div class="tab-cagr" style="color:var(--cons)">+7.4%</div>
    <div class="tab-mdd">MaxDD -4.0%</div>
    <div class="tab-risk" style="color:var(--cons)">TF 1.0% · CP 0.5%</div>
  </div>
  <div class="tab" id="tab-bal" style="--tc:var(--bal)" onclick="setProfile('bal')">
    <div class="tab-label">Bilanciato ★</div>
    <div class="tab-cagr" style="color:var(--bal)">+13.5%</div>
    <div class="tab-mdd">MaxDD -7.1%</div>
    <div class="tab-risk" style="color:var(--bal)">TF 1.8% · CP 0.9%</div>
  </div>
  <div class="tab" id="tab-agg" style="--tc:var(--agg)" onclick="setProfile('agg')">
    <div class="tab-label">Aggressivo</div>
    <div class="tab-cagr" style="color:var(--agg)">+18.9%</div>
    <div class="tab-mdd">MaxDD -9.9%</div>
    <div class="tab-risk" style="color:var(--agg)">TF 2.5% · CP 1.25%</div>
  </div>
</div>

<!-- KPI ROW (dynamic) -->
<div class="kpi-row" id="kpi-row">
  <div class="kpi ok"><div class="kpi-l">Profit Factor</div><div class="kpi-v">2.08</div><div class="kpi-t">1.25–2.0</div></div><div class="kpi ok"><div class="kpi-l">Win Rate</div><div class="kpi-v">52.1%</div><div class="kpi-t">35–60%</div></div><div class="kpi ok"><div class="kpi-l">E[R]</div><div class="kpi-v">+0.504R</div><div class="kpi-t">>+0.15R</div></div><div class="kpi warn"><div class="kpi-l">CAGR</div><div class="kpi-v">+7.4%</div><div class="kpi-t">>8%</div></div><div class="kpi ok"><div class="kpi-l">Sharpe</div><div class="kpi-v">1.018</div><div class="kpi-t">0.6–1.2</div></div><div class="kpi ok"><div class="kpi-l">Sortino</div><div class="kpi-v">1.245</div><div class="kpi-t">>1.0</div></div><div class="kpi warn"><div class="kpi-l">Max DD</div><div class="kpi-v">-4.0%</div><div class="kpi-t">13–20%</div></div>
</div>

<!-- CHARTS ROW 1 -->
<div class="cg1">
  <div class="card">
    <div class="ch"><span class="ch-dot"></span>Equity Curve — tutti e 3 i profili (base 100)</div>
    <canvas id="eqC"></canvas>
  </div>
  <div class="card">
    <div class="ch"><span class="ch-dot" style="background:var(--r)"></span>Drawdown % — profilo attivo</div>
    <canvas id="ddC"></canvas>
  </div>
</div>

<!-- SCATTER: CAGR vs DD (la mappa del rischio) -->
<div class="scatter-card">
  <div class="ch"><span class="ch-dot" style="background:var(--y)"></span>Mappa Rischio — CAGR% vs Max DD% al variare del risk/trade TF</div>
  <canvas id="scC" style="max-height:200px"></canvas>
</div>

<!-- CHARTS ROW 2 -->
<div class="cg2">
  <div class="card">
    <div class="ch"><span class="ch-dot" style="background:var(--b)"></span>Breakdown segnali</div>
    <table id="bt-table">
      <thead><tr><th>Tipo</th><th>N</th><th>WR</th><th>E[R]</th><th>PF</th></tr></thead>
      <tbody><tr>
          <td><span class="tag tag-cp">CP</span></td>
          <td class="mono">71</td>
          <td class="mono" style="color:#00d4aa">52.1%</td>
          <td class="mono" style="color:#00d4aa">+0.378</td>
          <td class="mono" style="color:#00d4aa">1.79</td>
        </tr><tr>
          <td><span class="tag tag-mom">MOM</span></td>
          <td class="mono">9</td>
          <td class="mono" style="color:#00d4aa">66.7%</td>
          <td class="mono" style="color:#00d4aa">+1.439</td>
          <td class="mono" style="color:#00d4aa">5.32</td>
        </tr><tr>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono">133</td>
          <td class="mono" style="color:#00d4aa">51.1%</td>
          <td class="mono" style="color:#00d4aa">+0.509</td>
          <td class="mono" style="color:#00d4aa">2.08</td>
        </tr></tbody>
    </table>
  </div>
  <div class="card">
    <div class="ch"><span class="ch-dot" style="background:var(--y)"></span>MaxDD per anno — profilo attivo</div>
    <div class="hy" id="hy"><div class="hy-cell" style="background:rgba(42,76,76,0.23616318988580848);border-color:rgba(42,76,76,0.36893055190864676)"><div class="hy-yr">2013</div><div class="hy-val">-3.4%</div></div><div class="hy-cell" style="background:rgba(30,80,80,0.21200125000000036);border-color:rgba(30,80,80,0.3496010000000003)"><div class="hy-yr">2014</div><div class="hy-val">-2.5%</div></div><div class="hy-cell" style="background:rgba(48,73,73,0.24862884722498388);border-color:rgba(48,73,73,0.3789030777799871)"><div class="hy-yr">2015</div><div class="hy-val">-3.9%</div></div><div class="hy-cell" style="background:rgba(43,75,75,0.23710535138477346);border-color:rgba(43,75,75,0.36968428110781876)"><div class="hy-yr">2016</div><div class="hy-val">-3.5%</div></div><div class="hy-cell" style="background:rgba(48,73,73,0.24861847972588186);border-color:rgba(48,73,73,0.3788947837807055)"><div class="hy-yr">2017</div><div class="hy-val">-3.9%</div></div><div class="hy-cell" style="background:rgba(24,82,82,0.19975000000000037);border-color:rgba(24,82,82,0.3398000000000003)"><div class="hy-yr">2018</div><div class="hy-val">-2.0%</div></div><div class="hy-cell" style="background:rgba(24,82,82,0.19974999999999962);border-color:rgba(24,82,82,0.33979999999999966)"><div class="hy-yr">2019</div><div class="hy-val">-2.0%</div></div><div class="hy-cell" style="background:rgba(36,78,78,0.2246022847586705);border-color:rgba(36,78,78,0.3596818278069364)"><div class="hy-yr">2020</div><div class="hy-val">-3.0%</div></div><div class="hy-cell" style="background:rgba(48,73,73,0.248509975);border-color:rgba(48,73,73,0.37880798)"><div class="hy-yr">2021</div><div class="hy-val">-3.9%</div></div><div class="hy-cell" style="background:rgba(30,80,80,0.21200125000000053);border-color:rgba(30,80,80,0.3496010000000004)"><div class="hy-yr">2022</div><div class="hy-val">-2.5%</div></div><div class="hy-cell" style="background:rgba(30,80,80,0.2120012500000002);border-color:rgba(30,80,80,0.34960100000000016)"><div class="hy-yr">2023</div><div class="hy-val">-2.5%</div></div><div class="hy-cell" style="background:rgba(24,82,82,0.199688125);border-color:rgba(24,82,82,0.33975049999999996)"><div class="hy-yr">2024</div><div class="hy-val">-2.0%</div></div><div class="hy-cell" style="background:rgba(46,74,74,0.2447067783179061);border-color:rgba(46,74,74,0.3757654226543249)"><div class="hy-yr">2025</div><div class="hy-val">-3.8%</div></div><div class="hy-cell" style="background:rgba(12,87,87,0.1750000000000001);border-color:rgba(12,87,87,0.32000000000000006)"><div class="hy-yr">2026</div><div class="hy-val">-1.0%</div></div></div>
  </div>
  <div class="card">
    <div class="ch"><span class="ch-dot" style="background:var(--y)"></span>Trade recenti</div>
    <div style="overflow-y:auto;max-height:230px">
      <table id="tr-table">
        <thead><tr><th>Entry</th><th>Tipo</th><th>R</th><th>Dur</th><th></th></tr></thead>
        <tbody id="tr-body"><tr>
          <td class="mono sm muted">2024-01-31</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+1.98R</td>
          <td class="mono sm muted">9d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2024-02-29</td>
          <td><span class="tag tag-mom">MOM</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">3d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2024-03-06</td>
          <td><span class="tag tag-cp">CP</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+1.93R</td>
          <td class="mono sm muted">7d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2024-03-19</td>
          <td><span class="tag tag-cp">CP</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+0.54R</td>
          <td class="mono sm muted">12d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2024-04-08</td>
          <td><span class="tag tag-cp">CP</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">5d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2024-04-17</td>
          <td><span class="tag tag-cp">CP</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">2d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2024-05-15</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">11d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2024-06-10</td>
          <td><span class="tag tag-mom">MOM</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+3.00R</td>
          <td class="mono sm muted">12d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2024-06-28</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+1.82R</td>
          <td class="mono sm muted">8d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2024-09-13</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">12d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2024-10-02</td>
          <td><span class="tag tag-cp">CP</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">4d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2024-12-04</td>
          <td><span class="tag tag-cp">CP</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+1.32R</td>
          <td class="mono sm muted">10d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2024-12-19</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">5d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2025-01-22</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">3d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2025-01-28</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">2d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2025-04-29</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+3.00R</td>
          <td class="mono sm muted">7d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2025-05-09</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+1.79R</td>
          <td class="mono sm muted">12d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2025-05-29</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+2.17R</td>
          <td class="mono sm muted">12d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2025-06-17</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+2.46R</td>
          <td class="mono sm muted">12d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2025-07-08</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+1.42R</td>
          <td class="mono sm muted">11d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2025-07-24</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+4.00R</td>
          <td class="mono sm muted">5d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2025-08-01</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">12d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2025-10-06</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">3d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr><tr>
          <td class="mono sm muted">2025-10-22</td>
          <td><span class="tag tag-mom">MOM</span></td>
          <td class="mono" style="color:#00d4aa;font-weight:700">+4.00R</td>
          <td class="mono sm muted">4d</td>
          <td class="mono sm" style="color:#00d4aa">WIN</td>
        </tr><tr>
          <td class="mono sm muted">2025-10-29</td>
          <td><span class="tag tag-tf">TF</span></td>
          <td class="mono" style="color:#f75c5c;font-weight:700">-1.00R</td>
          <td class="mono sm muted">1d</td>
          <td class="mono sm" style="color:#f75c5c">LOSS</td>
        </tr></tbody>
      </table>
    </div>
  </div>
</div>

<!-- BOTTOM: params + exit + risk simulator -->
<div class="bot">
  <!-- Params -->
  <div class="card">
    <div class="ch"><span class="ch-dot" style="background:var(--b)"></span>Parametri ottimizzati</div>
    <table><tbody>
      <tr><td class="muted sm">ER minimo</td><td class="mono" style="color:var(--g)">0.22</td></tr>
      <tr><td class="muted sm">ADX minimo</td><td class="mono" style="color:var(--g)">10</td></tr>
      <tr><td class="muted sm">BW max (CP)</td><td class="mono" style="color:var(--g)">20</td></tr>
      <tr><td class="muted sm">Max holding</td><td class="mono" style="color:var(--g)">12 barre</td></tr>
      <tr><td class="muted sm">Stop TF/CP</td><td class="mono" style="color:var(--g)">1.2×ATR</td></tr>
      <tr><td class="muted sm">Target 1</td><td class="mono" style="color:var(--g)">2.0×ATR → 50%</td></tr>
      <tr><td class="muted sm">Target 2</td><td class="mono" style="color:var(--g)">4.0×ATR trail</td></tr>
      <tr><td class="muted sm">RSI (MR)</td><td class="mono" style="color:var(--y)">&lt;40</td></tr>
    </tbody></table>
    <div style="margin-top:18px">
      <div class="ch"><span class="ch-dot" style="background:var(--y)"></span>Exit flow</div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:.74rem">
        <div style="padding:10px;background:var(--s2);border-radius:8px;border-top:2px solid var(--r)">
          <b>Stop</b><br><span class="muted">1.2×ATR</span></div>
        <div style="padding:10px;background:var(--s2);border-radius:8px;border-top:2px solid var(--b)">
          <b>T1 50%</b><br><span class="muted">2.0×ATR → BE</span></div>
        <div style="padding:10px;background:var(--s2);border-radius:8px;border-top:2px solid var(--y)">
          <b>Trail</b><br><span class="muted">−1.5×ATR</span></div>
        <div style="padding:10px;background:var(--s2);border-radius:8px;border-top:2px solid var(--g)">
          <b>T2/out</b><br><span class="muted">4.0×ATR / 12d</span></div>
      </div>
    </div>
  </div>
  <!-- Risk simulator -->
  <div class="card" style="grid-column:span 2">
    <div class="ch"><span class="ch-dot" style="background:var(--y)"></span>Simulatore rischio interattivo</div>
    <div class="slider-row">
      <label>Risk/trade TF:</label>
      <input type="range" id="slRisk" min="0.5" max="3.0" step="0.25" value="1.8" oninput="updateSim(this.value)">
      <span class="slider-val" id="slVal">1.8%</span>
    </div>
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:18px" id="sim-kpis">
      <div class="kpi ok" id="sim-cagr"><div class="kpi-l">CAGR est.</div><div class="kpi-v" id="sv-cagr">—</div><div class="kpi-t">annualizzato</div></div>
      <div class="kpi" id="sim-mdd"><div class="kpi-l">Max DD est.</div><div class="kpi-v" id="sv-mdd">—</div><div class="kpi-t">storico</div></div>
      <div class="kpi ok"><div class="kpi-l">Sharpe</div><div class="kpi-v" id="sv-sh">—</div><div class="kpi-t">daily ×√252</div></div>
      <div class="kpi ok"><div class="kpi-l">Risk/trade CP</div><div class="kpi-v" id="sv-cp">—</div><div class="kpi-t">= TF × 0.5</div></div>
    </div>
    <div class="ch"><span class="ch-dot" style="background:var(--g)"></span>CAGR vs MaxDD — curva di frontiera efficiente</div>
    <canvas id="frontC" style="max-height:180px"></canvas>
  </div>
</div>

<div class="disc">
  ⚠ <b>Avvertenze:</b> Backtest walk-forward no-lookahead su 13 anni MSFT 1D, 213 trade.
  Il CAGR è <b>lineare col rischio</b> (stessa equity curve, scala diversa) — il MaxDD cresce quasi linearmente.
  Sharpe rimane costante al variare del rischio (matematica del Kelly). La relazione rischio→rendimento
  è stabile su questo dataset ma non garantita OOS. Il Max DD reale in scenari inediti potrebbe essere
  1.5–2× il valore storico. Non costituisce consulenza finanziaria.
</div>
</div>

<script>
Chart.defaults.color='#5a6480';
Chart.defaults.borderColor='#1e2535';
Chart.defaults.font.family="'DM Mono',monospace";
Chart.defaults.font.size=10;

// ── DATA ──────────────────────────────────────────────────────────────────
const CONS_EQ = [100.0, 100.0, 101.05, 101.05, 101.05, 101.05, 100.55, 100.55, 100.55, 100.55, 100.55, 100.55, 100.55, 99.55, 99.55, 99.55, 99.55, 99.55, 99.55, 99.55, 99.55, 98.55, 98.55, 98.55, 98.55, 98.55, 98.55, 98.55, 98.55, 98.55, 97.57, 97.57, 97.57, 98.77, 98.77, 98.77, 98.77, 100.84, 99.83, 99.83, 99.83, 100.8, 99.79, 99.79, 99.79, 99.79, 99.79, 99.79, 99.79, 99.79, 99.79, 99.79, 99.79, 98.79, 98.79, 98.79, 98.79, 98.79, 99.52, 99.52, 99.52, 99.52, 101.68, 101.68, 100.66, 100.66, 99.65, 99.65, 99.65, 99.65, 100.49, 100.49, 100.49, 100.49, 100.49, 100.97, 100.97, 100.97, 100.97, 101.64, 100.62, 100.62, 100.62, 100.62, 100.88, 100.88, 102.4, 102.4, 101.37, 100.36, 99.86, 99.86, 99.86, 99.86, 99.86, 99.86, 99.99, 99.99, 101.86, 101.86, 100.84, 100.84, 100.84, 100.34, 100.34, 100.34, 100.34, 100.34, 100.34, 100.34, 103.35, 101.29, 101.29, 101.29, 101.29, 101.29, 101.29, 101.29, 101.29, 101.29, 101.29, 101.29, 100.78, 100.78, 100.78, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 100.28, 104.29, 104.29, 104.29, 103.25, 103.25, 104.53, 104.53, 104.01, 103.49, 103.49, 103.49, 102.97, 102.97, 102.97, 102.97, 102.97, 102.97, 102.97, 101.94, 101.43, 101.43, 102.44, 101.42, 101.42, 100.4, 100.4, 100.4, 100.4, 100.4, 100.4, 100.4, 100.4, 100.4, 100.4, 100.4, 100.4, 102.47, 106.57, 105.5, 105.5, 105.5, 105.5, 106.03, 106.03, 106.03, 106.03, 107.02, 106.49, 105.42, 105.42, 105.42, 104.9, 104.9, 104.9, 104.9, 104.9, 104.9, 104.37, 104.37, 104.37, 104.37, 104.37, 104.37, 104.37, 104.37, 104.37, 104.37, 104.37, 104.37, 105.26, 105.26, 105.26, 105.26, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 104.73, 107.87, 107.87, 107.87, 107.87, 110.12, 109.02, 109.02, 109.02, 109.02, 109.04, 109.04, 109.04, 109.04, 109.04, 109.04, 109.04, 109.04, 109.04, 109.04, 109.04, 109.04, 107.95, 106.87, 106.33, 106.33, 106.33, 106.33, 106.33, 106.33, 106.33, 106.33, 107.36, 106.28, 106.28, 106.28, 106.28, 106.28, 106.28, 109.47, 108.38, 108.38, 108.38, 108.38, 109.02, 107.93, 106.85, 106.85, 106.85, 106.85, 105.78, 105.78, 105.78, 106.73, 106.73, 106.73, 106.73, 109.93, 109.93, 109.93, 109.93, 109.07, 109.07, 109.07, 112.34, 112.34, 111.22, 111.22, 111.22, 111.23, 111.23, 111.23, 111.23, 111.23, 111.23, 111.23, 110.11, 110.11, 110.11, 110.11, 110.11, 110.29, 110.29, 110.29, 110.29, 110.29, 110.47, 110.47, 110.47, 110.47, 110.47, 110.47, 113.37, 113.37, 116.77, 116.77, 116.77, 115.92, 115.92, 115.92, 117.55, 117.55, 117.55, 117.55, 117.55, 117.55, 117.55, 117.83, 117.83, 117.83, 119.98, 119.98, 123.58, 124.81, 124.81, 124.81, 124.81, 124.81, 124.81, 124.81, 124.81, 123.57, 123.57, 123.57, 123.57, 123.57, 123.57, 123.57, 123.57, 122.33, 122.33, 122.33, 122.33, 123.24, 123.24, 123.24, 123.24, 125.27, 125.27, 125.27, 124.02, 124.02, 123.4, 123.4, 123.4, 125.21, 125.21, 125.21, 127.88, 127.88, 127.88, 127.88, 128.87, 128.87, 128.87, 128.87, 129.94, 129.94, 129.94, 129.94, 131.5, 131.5, 130.19, 130.19, 130.19, 130.19, 130.19, 130.19, 130.19, 130.19, 130.19, 130.19, 130.19, 130.19, 129.54, 129.54, 129.54, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 128.89, 129.88, 129.88, 131.83, 131.83, 131.83, 131.83, 133.57, 133.57, 133.57, 133.57, 135.58, 134.22, 132.88, 132.88, 132.88, 134.21, 134.21, 134.21, 134.21, 134.21, 134.21, 134.21, 135.85, 135.85, 135.85, 135.85, 137.23, 137.23, 137.23, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 139.14, 140.75, 140.75, 140.75, 140.75, 142.89, 142.89, 142.89, 146.76, 146.76, 146.76, 146.76, 150.17, 150.17, 150.17, 150.17, 152.73, 152.73, 157.31, 159.83, 159.83, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 158.23, 159.3, 159.3, 159.3, 159.3, 159.65, 158.85, 158.85, 158.85, 160.27, 160.27, 160.27, 160.27, 161.46, 161.46, 161.46, 161.74, 161.74, 160.12, 160.12, 160.12, 161.38, 161.38, 161.38, 161.38, 163.8, 162.16, 162.16, 162.16, 162.16, 162.16, 162.16, 162.16, 162.16, 162.16, 160.54, 160.54, 159.74, 159.74, 159.74, 158.94, 158.94, 158.94, 158.94, 158.91, 158.91, 158.91, 158.91, 158.91, 158.91, 158.91, 158.12, 158.12, 158.12, 158.12, 158.12, 160.14, 160.14, 160.14, 160.14, 159.66, 159.66, 158.86, 158.86, 158.86, 158.86, 158.86, 158.86, 158.86, 158.86, 158.86, 158.86, 162.09, 162.09, 160.47, 159.67, 159.67, 159.67, 159.67, 159.67, 159.67, 159.67, 159.67, 159.67, 159.67, 159.67, 163.47, 163.47, 163.47, 167.12, 167.12, 170.17, 170.17, 170.17, 170.17, 172.75, 171.03, 171.03, 169.32, 169.32, 165.95, 165.95, 168.06, 168.06, 167.22, 167.22, 167.22, 167.22, 167.22, 167.22, 170.56, 170.56, 170.56, 170.56, 174.15, 175.89, 175.89, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 175.01, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 173.26, 171.53, 171.53, 171.53, 171.53, 171.53, 173.42, 173.42, 173.42, 174.25, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 173.38, 172.51, 172.51, 172.51, 172.51, 172.51, 172.51, 172.51, 173.43, 173.43, 172.56, 172.56, 172.56, 172.56, 171.7, 171.7, 171.7, 171.7, 171.7, 171.7, 171.7, 176.85, 176.85, 175.08, 175.08, 174.21, 174.21, 174.21, 174.21, 174.21, 174.21, 176.97, 176.97, 176.97, 176.97, 176.57, 183.64, 183.64, 183.64, 183.64, 184.21, 184.21, 184.21, 189.74, 189.74, 189.74, 193.75, 193.75, 193.75, 193.75, 193.75, 192.78, 192.78, 195.68, 194.7, 194.7, 194.7, 194.7, 194.7, 194.7, 194.7, 194.7, 194.7, 194.7, 194.7, 192.75, 192.75, 192.75, 192.75, 192.75, 192.75, 192.75, 190.82, 191.8, 191.8, 191.8, 197.56, 197.56, 197.56, 197.56, 201.34, 201.34, 201.34, 201.34, 201.34, 201.34, 202.72, 202.72, 205.76, 205.76, 205.76, 205.76, 211.94, 211.94, 211.94, 216.14, 216.14, 216.14, 216.14, 213.98, 213.98, 216.05, 216.05, 216.05, 216.05, 216.63, 216.63, 215.55, 214.47, 214.47, 214.47, 214.47, 214.47, 214.47, 214.47, 214.47, 212.33, 212.33, 212.33, 212.33, 212.33, 212.33, 218.7, 218.7, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 222.68, 220.45, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 219.35, 220.8, 220.8, 218.59, 218.59, 218.59, 218.59, 218.59, 218.59, 216.41, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 214.24, 220.67, 220.67, 220.67, 220.67, 224.63, 224.63, 224.63, 229.5, 229.5, 229.5, 229.5, 229.5, 235.14, 235.14, 235.14, 238.48, 248.01, 248.01, 248.01, 248.01, 245.53, 245.53, 245.53, 245.53, 245.53, 245.53, 245.53, 245.53, 245.53, 245.53, 243.08, 243.08, 243.08, 243.08, 252.8, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27, 250.27];
const BAL_EQ  = [100.0, 100.0, 101.89, 101.89, 101.89, 101.89, 100.99, 100.99, 100.99, 100.99, 100.99, 100.99, 100.99, 99.17, 99.17, 99.17, 99.17, 99.17, 99.17, 99.17, 99.17, 97.38, 97.38, 97.38, 97.38, 97.38, 97.38, 97.38, 97.38, 97.38, 95.63, 95.63, 95.63, 97.75, 97.75, 97.75, 97.75, 101.44, 99.61, 99.61, 99.61, 101.35, 99.53, 99.53, 99.53, 99.53, 99.53, 99.53, 99.53, 99.53, 99.53, 99.53, 99.53, 97.74, 97.74, 97.74, 97.74, 97.74, 99.04, 99.04, 99.04, 99.04, 102.9, 102.9, 101.05, 101.05, 99.23, 99.23, 99.23, 99.23, 100.73, 100.73, 100.73, 100.73, 100.73, 101.6, 101.6, 101.6, 101.6, 102.8, 100.95, 100.95, 100.95, 100.95, 101.42, 101.42, 104.16, 104.16, 102.29, 100.45, 99.54, 99.54, 99.54, 99.54, 99.54, 99.54, 99.78, 99.78, 103.14, 103.14, 101.28, 101.28, 101.28, 100.37, 100.37, 100.37, 100.37, 100.37, 100.37, 100.37, 105.79, 102.02, 102.02, 102.02, 102.02, 102.02, 102.02, 102.02, 102.02, 102.02, 102.02, 102.02, 101.1, 101.1, 101.1, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 100.19, 107.4, 107.4, 107.4, 105.47, 105.47, 107.82, 107.82, 106.85, 105.89, 105.89, 105.89, 104.94, 104.94, 104.94, 104.94, 104.94, 104.94, 104.94, 103.05, 102.12, 102.12, 103.96, 102.09, 102.09, 100.25, 100.25, 100.25, 100.25, 100.25, 100.25, 100.25, 100.25, 100.25, 100.25, 100.25, 100.25, 103.96, 111.45, 109.44, 109.44, 109.44, 109.44, 110.42, 110.42, 110.42, 110.42, 112.29, 111.27, 109.27, 109.27, 109.27, 108.29, 108.29, 108.29, 108.29, 108.29, 108.29, 107.31, 107.31, 107.31, 107.31, 107.31, 107.31, 107.31, 107.31, 107.31, 107.31, 107.31, 107.31, 108.95, 108.95, 108.95, 108.95, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 107.97, 113.8, 113.8, 113.8, 113.8, 118.07, 115.95, 115.95, 115.95, 115.95, 115.98, 115.98, 115.98, 115.98, 115.98, 115.98, 115.98, 115.98, 115.98, 115.98, 115.98, 115.98, 113.89, 111.84, 110.83, 110.83, 110.83, 110.83, 110.83, 110.83, 110.83, 110.83, 112.76, 110.73, 110.73, 110.73, 110.73, 110.73, 110.73, 116.71, 114.61, 114.61, 114.61, 114.61, 115.82, 113.74, 111.69, 111.69, 111.69, 111.69, 109.68, 109.68, 109.68, 111.46, 111.46, 111.46, 111.46, 117.47, 117.47, 117.47, 117.47, 115.81, 115.81, 115.81, 122.06, 122.06, 119.87, 119.87, 119.87, 119.88, 119.88, 119.88, 119.88, 119.88, 119.88, 119.88, 117.73, 117.73, 117.73, 117.73, 117.73, 118.07, 118.07, 118.07, 118.07, 118.07, 118.39, 118.39, 118.39, 118.39, 118.39, 118.39, 123.99, 123.99, 130.68, 130.68, 130.68, 128.98, 128.98, 128.98, 132.24, 132.24, 132.24, 132.24, 132.24, 132.24, 132.24, 132.8, 132.8, 132.8, 137.16, 137.16, 144.57, 147.17, 147.17, 147.17, 147.17, 147.17, 147.17, 147.17, 147.17, 144.52, 144.52, 144.52, 144.52, 144.52, 144.52, 144.52, 144.52, 141.92, 141.92, 141.92, 141.92, 143.82, 143.82, 143.82, 143.82, 148.08, 148.08, 148.08, 145.42, 145.42, 144.11, 144.11, 144.11, 147.93, 147.93, 147.93, 153.59, 153.59, 153.59, 153.59, 155.74, 155.74, 155.74, 155.74, 158.06, 158.06, 158.06, 158.06, 161.48, 161.48, 158.58, 158.58, 158.58, 158.58, 158.58, 158.58, 158.58, 158.58, 158.58, 158.58, 158.58, 158.58, 157.15, 157.15, 157.15, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 155.73, 157.89, 157.89, 162.15, 162.15, 162.15, 162.15, 166.02, 166.02, 166.02, 166.02, 170.5, 167.43, 164.42, 164.42, 164.42, 167.38, 167.38, 167.38, 167.38, 167.38, 167.38, 167.38, 171.07, 171.07, 171.07, 171.07, 174.15, 174.15, 174.15, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 178.51, 182.23, 182.23, 182.23, 182.23, 187.22, 187.22, 187.22, 196.33, 196.33, 196.33, 196.33, 204.55, 204.55, 204.55, 204.55, 210.82, 210.82, 222.21, 228.61, 228.61, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 224.5, 227.23, 227.23, 227.23, 227.23, 228.11, 226.06, 226.06, 226.06, 229.71, 229.71, 229.71, 229.71, 232.77, 232.77, 232.77, 233.46, 233.46, 229.26, 229.26, 229.26, 232.49, 232.49, 232.49, 232.49, 238.77, 234.47, 234.47, 234.47, 234.47, 234.47, 234.47, 234.47, 234.47, 234.47, 230.25, 230.25, 228.18, 228.18, 228.18, 226.13, 226.13, 226.13, 226.13, 226.06, 226.06, 226.06, 226.06, 226.06, 226.06, 226.06, 224.02, 224.02, 224.02, 224.02, 224.02, 229.18, 229.18, 229.18, 229.18, 227.92, 227.92, 225.87, 225.87, 225.87, 225.87, 225.87, 225.87, 225.87, 225.87, 225.87, 225.87, 234.14, 234.14, 229.92, 227.85, 227.85, 227.85, 227.85, 227.85, 227.85, 227.85, 227.85, 227.85, 227.85, 227.85, 237.62, 237.62, 237.62, 247.16, 247.16, 255.31, 255.31, 255.31, 255.31, 262.27, 257.55, 257.55, 252.91, 252.91, 243.89, 243.89, 249.48, 249.48, 247.24, 247.24, 247.24, 247.24, 247.24, 247.24, 256.14, 256.14, 256.14, 256.14, 265.82, 270.6, 270.6, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 268.17, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 263.34, 258.6, 258.6, 258.6, 258.6, 258.6, 263.75, 263.75, 263.75, 266.0, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 263.61, 261.24, 261.24, 261.24, 261.24, 261.24, 261.24, 261.24, 263.75, 263.75, 261.38, 261.38, 261.38, 261.38, 259.03, 259.03, 259.03, 259.03, 259.03, 259.03, 259.03, 273.02, 273.02, 268.1, 268.1, 265.69, 265.69, 265.69, 265.69, 265.69, 265.69, 273.28, 273.28, 273.28, 273.28, 272.17, 291.76, 291.76, 291.76, 291.76, 293.41, 293.41, 293.41, 309.25, 309.25, 309.25, 321.03, 321.03, 321.03, 321.03, 321.03, 318.14, 318.14, 326.74, 323.79, 323.79, 323.79, 323.79, 323.79, 323.79, 323.79, 323.79, 323.79, 323.79, 323.79, 317.97, 317.97, 317.97, 317.97, 317.97, 317.97, 317.97, 312.24, 315.13, 315.13, 315.13, 332.15, 332.15, 332.15, 332.15, 343.58, 343.58, 343.58, 343.58, 343.58, 343.58, 347.84, 347.84, 357.23, 357.23, 357.23, 357.23, 376.52, 376.52, 376.52, 389.97, 389.97, 389.97, 389.97, 382.95, 382.95, 389.61, 389.61, 389.61, 389.61, 391.5, 391.5, 387.98, 384.49, 384.49, 384.49, 384.49, 384.49, 384.49, 384.49, 384.49, 377.57, 377.57, 377.57, 377.57, 377.57, 377.57, 397.95, 397.95, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 411.0, 403.6, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 399.97, 404.73, 404.73, 397.45, 397.45, 397.45, 397.45, 397.45, 397.45, 390.29, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 383.27, 403.97, 403.97, 403.97, 403.97, 417.0, 417.0, 417.0, 433.3, 433.3, 433.3, 433.3, 433.3, 452.46, 452.46, 452.46, 464.01, 497.42, 497.42, 497.42, 497.42, 488.46, 488.46, 488.46, 488.46, 488.46, 488.46, 488.46, 488.46, 488.46, 488.46, 479.67, 479.67, 479.67, 479.67, 514.21, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95, 504.95];
const AGG_EQ  = [100.0, 100.0, 102.62, 102.62, 102.62, 102.62, 101.36, 101.36, 101.36, 101.36, 101.36, 101.36, 101.36, 98.83, 98.83, 98.83, 98.83, 98.83, 98.83, 98.83, 98.83, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 93.95, 93.95, 93.95, 96.84, 96.84, 96.84, 96.84, 101.92, 99.37, 99.37, 99.37, 101.77, 99.23, 99.23, 99.23, 99.23, 99.23, 99.23, 99.23, 99.23, 99.23, 99.23, 99.23, 96.75, 96.75, 96.75, 96.75, 96.75, 98.54, 98.54, 98.54, 98.54, 103.88, 103.88, 101.28, 101.28, 98.75, 98.75, 98.75, 98.75, 100.82, 100.82, 100.82, 100.82, 100.82, 102.03, 102.03, 102.03, 102.03, 103.7, 101.11, 101.11, 101.11, 101.11, 101.77, 101.77, 105.59, 105.59, 102.95, 100.38, 99.12, 99.12, 99.12, 99.12, 99.12, 99.12, 99.45, 99.45, 104.1, 104.1, 101.5, 101.5, 101.5, 100.23, 100.23, 100.23, 100.23, 100.23, 100.23, 100.23, 107.75, 102.43, 102.43, 102.43, 102.43, 102.43, 102.43, 102.43, 102.43, 102.43, 102.43, 102.43, 101.15, 101.15, 101.15, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 99.88, 109.87, 109.87, 109.87, 107.13, 107.13, 110.44, 110.44, 109.06, 107.7, 107.7, 107.7, 106.35, 106.35, 106.35, 106.35, 106.35, 106.35, 106.35, 103.69, 102.4, 102.4, 104.96, 102.33, 102.33, 99.77, 99.77, 99.77, 99.77, 99.77, 99.77, 99.77, 99.77, 99.77, 99.77, 99.77, 99.77, 104.91, 115.4, 112.52, 112.52, 112.52, 112.52, 113.91, 113.91, 113.91, 113.91, 116.58, 115.13, 112.25, 112.25, 112.25, 110.84, 110.84, 110.84, 110.84, 110.84, 110.84, 109.46, 109.46, 109.46, 109.46, 109.46, 109.46, 109.46, 109.46, 109.46, 109.46, 109.46, 109.46, 111.78, 111.78, 111.78, 111.78, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 110.39, 118.66, 118.66, 118.66, 118.66, 124.85, 121.73, 121.73, 121.73, 121.73, 121.77, 121.77, 121.77, 121.77, 121.77, 121.77, 121.77, 121.77, 121.77, 121.77, 121.77, 121.77, 118.73, 115.76, 114.31, 114.31, 114.31, 114.31, 114.31, 114.31, 114.31, 114.31, 117.07, 114.14, 114.14, 114.14, 114.14, 114.14, 114.14, 122.7, 119.64, 119.64, 119.64, 119.64, 121.39, 118.36, 115.4, 115.4, 115.4, 115.4, 112.52, 112.52, 112.52, 115.05, 115.05, 115.05, 115.05, 123.67, 123.67, 123.67, 123.67, 121.23, 121.23, 121.23, 130.33, 130.33, 127.07, 127.07, 127.07, 127.1, 127.1, 127.1, 127.1, 127.1, 127.1, 127.1, 123.92, 123.92, 123.92, 123.92, 123.92, 124.42, 124.42, 124.42, 124.42, 124.42, 124.87, 124.87, 124.87, 124.87, 124.87, 124.87, 133.06, 133.06, 143.04, 143.04, 143.04, 140.45, 140.45, 140.45, 145.39, 145.39, 145.39, 145.39, 145.39, 145.39, 145.39, 146.24, 146.24, 146.24, 152.91, 152.91, 164.38, 168.49, 168.49, 168.49, 168.49, 168.49, 168.49, 168.49, 168.49, 164.28, 164.28, 164.28, 164.28, 164.28, 164.28, 164.28, 164.28, 160.17, 160.17, 160.17, 160.17, 163.14, 163.14, 163.14, 163.14, 169.87, 169.87, 169.87, 165.62, 165.62, 163.55, 163.55, 163.55, 169.57, 169.57, 169.57, 178.59, 178.59, 178.59, 178.59, 182.05, 182.05, 182.05, 182.05, 185.82, 185.82, 185.82, 185.82, 191.41, 191.41, 186.62, 186.62, 186.62, 186.62, 186.62, 186.62, 186.62, 186.62, 186.62, 186.62, 186.62, 186.62, 184.29, 184.29, 184.29, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 181.99, 185.49, 185.49, 192.44, 192.44, 192.44, 192.44, 198.82, 198.82, 198.82, 198.82, 206.27, 201.11, 196.09, 196.09, 196.09, 200.99, 200.99, 200.99, 200.99, 200.99, 200.99, 200.99, 207.14, 207.14, 207.14, 207.14, 212.26, 212.26, 212.26, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 219.63, 225.99, 225.99, 225.99, 225.99, 234.57, 234.57, 234.57, 250.44, 250.44, 250.44, 250.44, 265.0, 265.0, 265.0, 265.0, 276.29, 276.29, 297.01, 308.9, 308.9, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 301.18, 306.27, 306.27, 306.27, 306.27, 307.92, 304.07, 304.07, 304.07, 310.89, 310.89, 310.89, 310.89, 316.64, 316.64, 316.64, 317.88, 317.88, 309.93, 309.93, 309.93, 316.01, 316.01, 316.01, 316.01, 327.86, 319.66, 319.66, 319.66, 319.66, 319.66, 319.66, 319.66, 319.66, 319.66, 311.67, 311.67, 307.77, 307.77, 307.77, 303.93, 303.93, 303.93, 303.93, 303.8, 303.8, 303.8, 303.8, 303.8, 303.8, 303.8, 300.0, 300.0, 300.0, 300.0, 300.0, 309.59, 309.59, 309.59, 309.59, 307.2, 307.2, 303.36, 303.36, 303.36, 303.36, 303.36, 303.36, 303.36, 303.36, 303.36, 303.36, 318.77, 318.77, 310.8, 306.92, 306.92, 306.92, 306.92, 306.92, 306.92, 306.92, 306.92, 306.92, 306.92, 306.92, 325.19, 325.19, 325.19, 343.33, 343.33, 359.04, 359.04, 359.04, 359.04, 372.64, 363.33, 363.33, 354.24, 354.24, 336.75, 336.75, 347.48, 347.48, 343.13, 343.13, 343.13, 343.13, 343.13, 343.13, 360.29, 360.29, 360.29, 360.29, 379.2, 388.68, 388.68, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 383.82, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 374.23, 364.87, 364.87, 364.87, 364.87, 364.87, 374.96, 374.96, 374.96, 379.42, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 374.67, 369.99, 369.99, 369.99, 369.99, 369.99, 369.99, 369.99, 374.94, 374.94, 370.25, 370.25, 370.25, 370.25, 365.63, 365.63, 365.63, 365.63, 365.63, 365.63, 365.63, 393.05, 393.05, 383.22, 383.22, 378.43, 378.43, 378.43, 378.43, 378.43, 378.43, 393.45, 393.45, 393.45, 393.45, 391.23, 430.35, 430.35, 430.35, 430.35, 433.71, 433.71, 433.71, 466.24, 466.24, 466.24, 490.9, 490.9, 490.9, 490.9, 490.9, 484.77, 484.77, 502.96, 496.67, 496.67, 496.67, 496.67, 496.67, 496.67, 496.67, 496.67, 496.67, 496.67, 496.67, 484.26, 484.26, 484.26, 484.26, 484.26, 484.26, 484.26, 472.15, 478.21, 478.21, 478.21, 514.08, 514.08, 514.08, 514.08, 538.65, 538.65, 538.65, 538.65, 538.65, 538.65, 547.93, 547.93, 568.47, 568.47, 568.47, 568.47, 611.11, 611.11, 611.11, 641.42, 641.42, 641.42, 641.42, 625.39, 625.39, 640.49, 640.49, 640.49, 640.49, 644.82, 644.82, 636.76, 628.8, 628.8, 628.8, 628.8, 628.8, 628.8, 628.8, 628.8, 613.08, 613.08, 613.08, 613.08, 613.08, 613.08, 659.06, 659.06, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 689.07, 671.84, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 663.44, 674.42, 674.42, 657.56, 657.56, 657.56, 657.56, 657.56, 657.56, 641.12, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 625.09, 671.97, 671.97, 671.97, 671.97, 702.08, 702.08, 702.08, 740.2, 740.2, 740.2, 740.2, 740.2, 785.65, 785.65, 785.65, 813.51, 894.86, 894.86, 894.86, 894.86, 872.49, 872.49, 872.49, 872.49, 872.49, 872.49, 872.49, 872.49, 872.49, 872.49, 850.68, 850.68, 850.68, 850.68, 935.74, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35, 912.35];
const CONS_DD = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.49, -0.49, -0.49, -0.49, -0.49, -0.49, -0.49, -1.49, -1.49, -1.49, -1.49, -1.49, -1.49, -1.49, -1.49, -2.47, -2.47, -2.47, -2.47, -2.47, -2.47, -2.47, -2.47, -2.47, -3.45, -3.45, -3.45, -2.26, -2.26, -2.26, -2.26, -0.21, -1.21, -1.21, -1.21, -0.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -2.23, -2.23, -2.23, -2.23, -2.23, -1.51, -1.51, -1.51, -1.51, 0.0, 0.0, -1.0, -1.0, -1.99, -1.99, -1.99, -1.99, -1.17, -1.17, -1.17, -1.17, -1.17, -0.69, -0.69, -0.69, -0.69, -0.04, -1.04, -1.04, -1.04, -1.04, -0.78, -0.78, 0.0, 0.0, -1.0, -1.99, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.35, -2.35, -0.52, -0.52, -1.52, -1.52, -1.52, -2.01, -2.01, -2.01, -2.01, -2.01, -2.01, -2.01, 0.0, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -2.48, -2.48, -2.48, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, -2.97, 0.0, 0.0, 0.0, -1.0, -1.0, 0.0, 0.0, -0.5, -1.0, -1.0, -1.0, -1.49, -1.49, -1.49, -1.49, -1.49, -1.49, -1.49, -2.48, -2.97, -2.97, -1.99, -2.97, -2.97, -3.95, -3.95, -3.95, -3.95, -3.95, -3.95, -3.95, -3.95, -3.95, -3.95, -3.95, -3.95, -1.97, 0.0, -1.0, -1.0, -1.0, -1.0, -0.51, -0.51, -0.51, -0.51, 0.0, -0.5, -1.49, -1.49, -1.49, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -1.65, -1.65, -1.65, -1.65, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, -2.14, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0, -1.0, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -1.98, -2.96, -3.44, -3.44, -3.44, -3.44, -3.44, -3.44, -3.44, -3.44, -2.51, -3.48, -3.48, -3.48, -3.48, -3.48, -3.48, -0.59, -1.58, -1.58, -1.58, -1.58, -1.0, -1.99, -2.97, -2.97, -2.97, -2.97, -3.94, -3.94, -3.94, -3.08, -3.08, -3.08, -3.08, -0.17, -0.17, -0.17, -0.17, -1.0, -1.0, -1.0, 0.0, 0.0, -1.0, -1.0, -1.0, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -0.99, -1.98, -1.98, -1.98, -1.98, -1.98, -1.82, -1.82, -1.82, -1.82, -1.82, -1.66, -1.66, -1.66, -1.66, -1.66, -1.66, 0.0, 0.0, 0.0, 0.0, 0.0, -0.72, -0.72, -0.72, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.99, -1.99, -1.99, -1.99, -1.26, -1.26, -1.26, -1.26, 0.0, 0.0, 0.0, -1.0, -1.0, -1.49, -1.49, -1.49, -0.05, -0.05, -0.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.5, -1.5, -1.5, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, -1.23, -1.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.99, -1.99, -1.99, -1.01, -1.01, -1.01, -1.01, -1.01, -1.01, -1.01, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.33, -0.33, -0.33, -0.33, -0.12, -0.61, -0.61, -0.61, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.99, -1.99, -1.99, -1.22, -1.22, -1.22, -1.22, 0.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.99, -1.99, -2.48, -2.48, -2.48, -2.97, -2.97, -2.97, -2.97, -2.98, -2.98, -2.98, -2.98, -2.98, -2.98, -2.98, -3.47, -3.47, -3.47, -3.47, -3.47, -2.23, -2.23, -2.23, -2.23, -2.53, -2.53, -3.01, -3.01, -3.01, -3.01, -3.01, -3.01, -3.01, -3.01, -3.01, -3.01, -1.04, -1.04, -2.03, -2.52, -2.52, -2.52, -2.52, -2.52, -2.52, -2.52, -2.52, -2.52, -2.52, -2.52, -0.2, -0.2, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.99, -1.99, -3.94, -3.94, -2.72, -2.72, -3.2, -3.2, -3.2, -3.2, -3.2, -3.2, -1.27, -1.27, -1.27, -1.27, 0.0, 0.0, 0.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -2.48, -2.48, -2.48, -2.48, -2.48, -1.4, -1.4, -1.4, -0.93, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.43, -1.92, -1.92, -1.92, -1.92, -1.92, -1.92, -1.92, -1.4, -1.4, -1.89, -1.89, -1.89, -1.89, -2.38, -2.38, -2.38, -2.38, -2.38, -2.38, -2.38, 0.0, 0.0, -1.0, -1.0, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, 0.0, 0.0, 0.0, 0.0, -0.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, -0.5, 0.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.49, -1.49, -1.49, -1.49, -1.49, -1.49, -1.49, -2.48, -1.98, -1.98, -1.98, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -0.04, -0.04, -0.04, -0.04, 0.0, 0.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.99, -1.99, -1.99, -1.99, -1.99, -1.99, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -0.84, -0.84, -1.83, -1.83, -1.83, -1.83, -1.83, -1.83, -2.82, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -3.79, -0.9, -0.9, -0.9, -0.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.99, -1.99, -1.99, -1.99, 0.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0];
const BAL_DD  = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.88, -0.88, -0.88, -0.88, -0.88, -0.88, -0.88, -2.67, -2.67, -2.67, -2.67, -2.67, -2.67, -2.67, -2.67, -4.42, -4.42, -4.42, -4.42, -4.42, -4.42, -4.42, -4.42, -4.42, -6.14, -6.14, -6.14, -4.06, -4.06, -4.06, -4.06, -0.44, -2.23, -2.23, -2.23, -0.53, -2.32, -2.32, -2.32, -2.32, -2.32, -2.32, -2.32, -2.32, -2.32, -2.32, -2.32, -4.08, -4.08, -4.08, -4.08, -4.08, -2.8, -2.8, -2.8, -2.8, 0.0, 0.0, -1.8, -1.8, -3.57, -3.57, -3.57, -3.57, -2.11, -2.11, -2.11, -2.11, -2.11, -1.26, -1.26, -1.26, -1.26, -0.1, -1.9, -1.9, -1.9, -1.9, -1.43, -1.43, 0.0, 0.0, -1.8, -3.57, -4.44, -4.44, -4.44, -4.44, -4.44, -4.44, -4.2, -4.2, -0.98, -0.98, -2.76, -2.76, -2.76, -3.64, -3.64, -3.64, -3.64, -3.64, -3.64, -3.64, 0.0, -3.57, -3.57, -3.57, -3.57, -3.57, -3.57, -3.57, -3.57, -3.57, -3.57, -3.57, -4.44, -4.44, -4.44, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, -5.3, 0.0, 0.0, 0.0, -1.8, -1.8, 0.0, 0.0, -0.9, -1.79, -1.79, -1.79, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -4.43, -5.29, -5.29, -3.58, -5.32, -5.32, -7.02, -7.02, -7.02, -7.02, -7.02, -7.02, -7.02, -7.02, -7.02, -7.02, -7.02, -7.02, -3.58, 0.0, -1.8, -1.8, -1.8, -1.8, -0.92, -0.92, -0.92, -0.92, 0.0, -0.9, -2.68, -2.68, -2.68, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -4.43, -4.43, -4.43, -4.43, -4.43, -4.43, -4.43, -4.43, -4.43, -4.43, -4.43, -4.43, -2.97, -2.97, -2.97, -2.97, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, -3.84, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -1.8, -1.8, -1.77, -1.77, -1.77, -1.77, -1.77, -1.77, -1.77, -1.77, -1.77, -1.77, -1.77, -1.77, -3.54, -5.28, -6.13, -6.13, -6.13, -6.13, -6.13, -6.13, -6.13, -6.13, -4.5, -6.22, -6.22, -6.22, -6.22, -6.22, -6.22, -1.16, -2.93, -2.93, -2.93, -2.93, -1.91, -3.67, -5.41, -5.41, -5.41, -5.41, -7.11, -7.11, -7.11, -5.61, -5.61, -5.61, -5.61, -0.51, -0.51, -0.51, -0.51, -1.92, -1.92, -1.92, 0.0, 0.0, -1.8, -1.8, -1.8, -1.78, -1.78, -1.78, -1.78, -1.78, -1.78, -1.78, -3.55, -3.55, -3.55, -3.55, -3.55, -3.27, -3.27, -3.27, -3.27, -3.27, -3.01, -3.01, -3.01, -3.01, -3.01, -3.01, 0.0, 0.0, 0.0, 0.0, 0.0, -1.3, -1.3, -1.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -3.57, -3.57, -3.57, -3.57, -2.28, -2.28, -2.28, -2.28, 0.0, 0.0, 0.0, -1.8, -1.8, -2.68, -2.68, -2.68, -0.11, -0.11, -0.11, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -2.68, -2.68, -2.68, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, -2.22, -2.22, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -3.57, -3.57, -3.57, -1.83, -1.83, -1.83, -1.83, -1.83, -1.83, -1.83, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -1.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -0.61, -0.61, -0.61, -0.61, -0.22, -1.12, -1.12, -1.12, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -3.57, -3.57, -3.57, -2.21, -2.21, -2.21, -2.21, 0.0, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -3.57, -3.57, -4.44, -4.44, -4.44, -5.3, -5.3, -5.3, -5.3, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -6.18, -6.18, -6.18, -6.18, -6.18, -4.02, -4.02, -4.02, -4.02, -4.54, -4.54, -5.4, -5.4, -5.4, -5.4, -5.4, -5.4, -5.4, -5.4, -5.4, -5.4, -1.94, -1.94, -3.71, -4.57, -4.57, -4.57, -4.57, -4.57, -4.57, -4.57, -4.57, -4.57, -4.57, -4.57, -0.48, -0.48, -0.48, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -3.57, -3.57, -7.01, -7.01, -4.88, -4.88, -5.73, -5.73, -5.73, -5.73, -5.73, -5.73, -2.34, -2.34, -2.34, -2.34, 0.0, 0.0, 0.0, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -4.44, -4.44, -4.44, -4.44, -4.44, -2.53, -2.53, -2.53, -1.7, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -2.58, -3.46, -3.46, -3.46, -3.46, -3.46, -3.46, -3.46, -2.53, -2.53, -3.41, -3.41, -3.41, -3.41, -4.28, -4.28, -4.28, -4.28, -4.28, -4.28, -4.28, 0.0, 0.0, -1.8, -1.8, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, 0.0, 0.0, 0.0, 0.0, -0.41, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.9, -0.9, 0.0, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -0.9, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -4.44, -3.55, -3.55, -3.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -0.09, -0.09, -0.09, -0.09, 0.0, 0.0, -0.9, -1.79, -1.79, -1.79, -1.79, -1.79, -1.79, -1.79, -1.79, -3.56, -3.56, -3.56, -3.56, -3.56, -3.56, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -2.68, -1.52, -1.52, -3.3, -3.3, -3.3, -3.3, -3.3, -3.3, -5.04, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -6.75, -1.71, -1.71, -1.71, -1.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -3.57, -3.57, -3.57, -3.57, 0.0, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8, -1.8];
const AGG_DD  = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.23, -1.23, -1.23, -1.23, -1.23, -1.23, -1.23, -3.7, -3.7, -3.7, -3.7, -3.7, -3.7, -3.7, -3.7, -6.1, -6.1, -6.1, -6.1, -6.1, -6.1, -6.1, -6.1, -6.1, -8.45, -8.45, -8.45, -5.64, -5.64, -5.64, -5.64, -0.69, -3.17, -3.17, -3.17, -0.83, -3.31, -3.31, -3.31, -3.31, -3.31, -3.31, -3.31, -3.31, -3.31, -3.31, -3.31, -5.72, -5.72, -5.72, -5.72, -5.72, -3.97, -3.97, -3.97, -3.97, 0.0, 0.0, -2.5, -2.5, -4.94, -4.94, -4.94, -4.94, -2.94, -2.94, -2.94, -2.94, -2.94, -1.78, -1.78, -1.78, -1.78, -0.17, -2.66, -2.66, -2.66, -2.66, -2.02, -2.02, 0.0, 0.0, -2.5, -4.94, -6.13, -6.13, -6.13, -6.13, -6.13, -6.13, -5.81, -5.81, -1.41, -1.41, -3.87, -3.87, -3.87, -5.08, -5.08, -5.08, -5.08, -5.08, -5.08, -5.08, 0.0, -4.94, -4.94, -4.94, -4.94, -4.94, -4.94, -4.94, -4.94, -4.94, -4.94, -4.94, -6.13, -6.13, -6.13, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, -7.3, 0.0, 0.0, 0.0, -2.5, -2.5, 0.0, 0.0, -1.25, -2.48, -2.48, -2.48, -3.7, -3.7, -3.7, -3.7, -3.7, -3.7, -3.7, -6.11, -7.28, -7.28, -4.97, -7.34, -7.34, -9.66, -9.66, -9.66, -9.66, -9.66, -9.66, -9.66, -9.66, -9.66, -9.66, -9.66, -9.66, -5.01, 0.0, -2.5, -2.5, -2.5, -2.5, -1.29, -1.29, -1.29, -1.29, 0.0, -1.25, -3.72, -3.72, -3.72, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -6.11, -6.11, -6.11, -6.11, -6.11, -6.11, -6.11, -6.11, -6.11, -6.11, -6.11, -6.11, -4.12, -4.12, -4.12, -4.12, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, -5.32, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -2.5, -2.5, -2.46, -2.46, -2.46, -2.46, -2.46, -2.46, -2.46, -2.46, -2.46, -2.46, -2.46, -2.46, -4.9, -7.28, -8.44, -8.44, -8.44, -8.44, -8.44, -8.44, -8.44, -8.44, -6.23, -8.57, -8.57, -8.57, -8.57, -8.57, -8.57, -1.72, -4.17, -4.17, -4.17, -4.17, -2.77, -5.2, -7.57, -7.57, -7.57, -7.57, -9.88, -9.88, -9.88, -7.85, -7.85, -7.85, -7.85, -0.94, -0.94, -0.94, -0.94, -2.89, -2.89, -2.89, 0.0, 0.0, -2.5, -2.5, -2.5, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -4.92, -4.92, -4.92, -4.92, -4.92, -4.53, -4.53, -4.53, -4.53, -4.53, -4.19, -4.19, -4.19, -4.19, -4.19, -4.19, 0.0, 0.0, 0.0, 0.0, 0.0, -1.81, -1.81, -1.81, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -4.94, -4.94, -4.94, -4.94, -3.17, -3.17, -3.17, -3.17, 0.0, 0.0, 0.0, -2.5, -2.5, -3.72, -3.72, -3.72, -0.18, -0.18, -0.18, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -3.72, -3.72, -3.72, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, -3.09, -3.09, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -4.94, -4.94, -4.94, -2.56, -2.56, -2.56, -2.56, -2.56, -2.56, -2.56, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -2.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -0.85, -0.85, -0.85, -0.85, -0.32, -1.56, -1.56, -1.56, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -4.94, -4.94, -4.94, -3.08, -3.08, -3.08, -3.08, 0.0, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -4.94, -4.94, -6.13, -6.13, -6.13, -7.3, -7.3, -7.3, -7.3, -7.34, -7.34, -7.34, -7.34, -7.34, -7.34, -7.34, -8.5, -8.5, -8.5, -8.5, -8.5, -5.57, -5.57, -5.57, -5.57, -6.3, -6.3, -7.47, -7.47, -7.47, -7.47, -7.47, -7.47, -7.47, -7.47, -7.47, -7.47, -2.77, -2.77, -5.2, -6.39, -6.39, -6.39, -6.39, -6.39, -6.39, -6.39, -6.39, -6.39, -6.39, -6.39, -0.81, -0.81, -0.81, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -4.94, -4.94, -9.63, -9.63, -6.75, -6.75, -7.92, -7.92, -7.92, -7.92, -7.92, -7.92, -3.32, -3.32, -3.32, -3.32, 0.0, 0.0, 0.0, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -6.13, -6.13, -6.13, -6.13, -6.13, -3.53, -3.53, -3.53, -2.38, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -3.6, -4.81, -4.81, -4.81, -4.81, -4.81, -4.81, -4.81, -3.54, -3.54, -4.74, -4.74, -4.74, -4.74, -5.93, -5.93, -5.93, -5.93, -5.93, -5.93, -5.93, 0.0, 0.0, -2.5, -2.5, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, 0.0, 0.0, 0.0, 0.0, -0.56, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.25, -1.25, 0.0, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -1.25, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -6.13, -4.92, -4.92, -4.92, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -0.14, -0.14, -0.14, -0.14, 0.0, 0.0, -1.25, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -2.48, -4.92, -4.92, -4.92, -4.92, -4.92, -4.92, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -3.72, -2.13, -2.13, -4.57, -4.57, -4.57, -4.57, -4.57, -4.57, -6.96, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -9.28, -2.48, -2.48, -2.48, -2.48, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -4.94, -4.94, -4.94, -4.94, 0.0, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5, -2.5];
const DAYS    = ["2013-05-15", "2013-05-20", "2013-05-25", "2013-05-30", "2013-06-04", "2013-06-09", "2013-06-14", "2013-06-19", "2013-06-24", "2013-06-29", "2013-07-04", "2013-07-09", "2013-07-14", "2013-07-19", "2013-07-24", "2013-07-29", "2013-08-03", "2013-08-08", "2013-08-13", "2013-08-18", "2013-08-23", "2013-08-28", "2013-09-02", "2013-09-07", "2013-09-12", "2013-09-17", "2013-09-22", "2013-09-27", "2013-10-02", "2013-10-07", "2013-10-12", "2013-10-17", "2013-10-22", "2013-10-27", "2013-11-01", "2013-11-06", "2013-11-11", "2013-11-16", "2013-11-21", "2013-11-26", "2013-12-01", "2013-12-06", "2013-12-11", "2013-12-16", "2013-12-21", "2013-12-26", "2013-12-31", "2014-01-05", "2014-01-10", "2014-01-15", "2014-01-20", "2014-01-25", "2014-01-30", "2014-02-04", "2014-02-09", "2014-02-14", "2014-02-19", "2014-02-24", "2014-03-01", "2014-03-06", "2014-03-11", "2014-03-16", "2014-03-21", "2014-03-26", "2014-03-31", "2014-04-05", "2014-04-10", "2014-04-15", "2014-04-20", "2014-04-25", "2014-04-30", "2014-05-05", "2014-05-10", "2014-05-15", "2014-05-20", "2014-05-25", "2014-05-30", "2014-06-04", "2014-06-09", "2014-06-14", "2014-06-19", "2014-06-24", "2014-06-29", "2014-07-04", "2014-07-09", "2014-07-14", "2014-07-19", "2014-07-24", "2014-07-29", "2014-08-03", "2014-08-08", "2014-08-13", "2014-08-18", "2014-08-23", "2014-08-28", "2014-09-02", "2014-09-07", "2014-09-12", "2014-09-17", "2014-09-22", "2014-09-27", "2014-10-02", "2014-10-07", "2014-10-12", "2014-10-17", "2014-10-22", "2014-10-27", "2014-11-01", "2014-11-06", "2014-11-11", "2014-11-16", "2014-11-21", "2014-11-26", "2014-12-01", "2014-12-06", "2014-12-11", "2014-12-16", "2014-12-21", "2014-12-26", "2014-12-31", "2015-01-05", "2015-01-10", "2015-01-15", "2015-01-20", "2015-01-25", "2015-01-30", "2015-02-04", "2015-02-09", "2015-02-14", "2015-02-19", "2015-02-24", "2015-03-01", "2015-03-06", "2015-03-11", "2015-03-16", "2015-03-21", "2015-03-26", "2015-03-31", "2015-04-05", "2015-04-10", "2015-04-15", "2015-04-20", "2015-04-25", "2015-04-30", "2015-05-05", "2015-05-10", "2015-05-15", "2015-05-20", "2015-05-25", "2015-05-30", "2015-06-04", "2015-06-09", "2015-06-14", "2015-06-19", "2015-06-24", "2015-06-29", "2015-07-04", "2015-07-09", "2015-07-14", "2015-07-19", "2015-07-24", "2015-07-29", "2015-08-03", "2015-08-08", "2015-08-13", "2015-08-18", "2015-08-23", "2015-08-28", "2015-09-02", "2015-09-07", "2015-09-12", "2015-09-17", "2015-09-22", "2015-09-27", "2015-10-02", "2015-10-07", "2015-10-12", "2015-10-17", "2015-10-22", "2015-10-27", "2015-11-01", "2015-11-06", "2015-11-11", "2015-11-16", "2015-11-21", "2015-11-26", "2015-12-01", "2015-12-06", "2015-12-11", "2015-12-16", "2015-12-21", "2015-12-26", "2015-12-31", "2016-01-05", "2016-01-10", "2016-01-15", "2016-01-20", "2016-01-25", "2016-01-30", "2016-02-04", "2016-02-09", "2016-02-14", "2016-02-19", "2016-02-24", "2016-02-29", "2016-03-05", "2016-03-10", "2016-03-15", "2016-03-20", "2016-03-25", "2016-03-30", "2016-04-04", "2016-04-09", "2016-04-14", "2016-04-19", "2016-04-24", "2016-04-29", "2016-05-04", "2016-05-09", "2016-05-14", "2016-05-19", "2016-05-24", "2016-05-29", "2016-06-03", "2016-06-08", "2016-06-13", "2016-06-18", "2016-06-23", "2016-06-28", "2016-07-03", "2016-07-08", "2016-07-13", "2016-07-18", "2016-07-23", "2016-07-28", "2016-08-02", "2016-08-07", "2016-08-12", "2016-08-17", "2016-08-22", "2016-08-27", "2016-09-01", "2016-09-06", "2016-09-11", "2016-09-16", "2016-09-21", "2016-09-26", "2016-10-01", "2016-10-06", "2016-10-11", "2016-10-16", "2016-10-21", "2016-10-26", "2016-10-31", "2016-11-05", "2016-11-10", "2016-11-15", "2016-11-20", "2016-11-25", "2016-11-30", "2016-12-05", "2016-12-10", "2016-12-15", "2016-12-20", "2016-12-25", "2016-12-30", "2017-01-04", "2017-01-09", "2017-01-14", "2017-01-19", "2017-01-24", "2017-01-29", "2017-02-03", "2017-02-08", "2017-02-13", "2017-02-18", "2017-02-23", "2017-02-28", "2017-03-05", "2017-03-10", "2017-03-15", "2017-03-20", "2017-03-25", "2017-03-30", "2017-04-04", "2017-04-09", "2017-04-14", "2017-04-19", "2017-04-24", "2017-04-29", "2017-05-04", "2017-05-09", "2017-05-14", "2017-05-19", "2017-05-24", "2017-05-29", "2017-06-03", "2017-06-08", "2017-06-13", "2017-06-18", "2017-06-23", "2017-06-28", "2017-07-03", "2017-07-08", "2017-07-13", "2017-07-18", "2017-07-23", "2017-07-28", "2017-08-02", "2017-08-07", "2017-08-12", "2017-08-17", "2017-08-22", "2017-08-27", "2017-09-01", "2017-09-06", "2017-09-11", "2017-09-16", "2017-09-21", "2017-09-26", "2017-10-01", "2017-10-06", "2017-10-11", "2017-10-16", "2017-10-21", "2017-10-26", "2017-10-31", "2017-11-05", "2017-11-10", "2017-11-15", "2017-11-20", "2017-11-25", "2017-11-30", "2017-12-05", "2017-12-10", "2017-12-15", "2017-12-20", "2017-12-25", "2017-12-30", "2018-01-04", "2018-01-09", "2018-01-14", "2018-01-19", "2018-01-24", "2018-01-29", "2018-02-03", "2018-02-08", "2018-02-13", "2018-02-18", "2018-02-23", "2018-02-28", "2018-03-05", "2018-03-10", "2018-03-15", "2018-03-20", "2018-03-25", "2018-03-30", "2018-04-04", "2018-04-09", "2018-04-14", "2018-04-19", "2018-04-24", "2018-04-29", "2018-05-04", "2018-05-09", "2018-05-14", "2018-05-19", "2018-05-24", "2018-05-29", "2018-06-03", "2018-06-08", "2018-06-13", "2018-06-18", "2018-06-23", "2018-06-28", "2018-07-03", "2018-07-08", "2018-07-13", "2018-07-18", "2018-07-23", "2018-07-28", "2018-08-02", "2018-08-07", "2018-08-12", "2018-08-17", "2018-08-22", "2018-08-27", "2018-09-01", "2018-09-06", "2018-09-11", "2018-09-16", "2018-09-21", "2018-09-26", "2018-10-01", "2018-10-06", "2018-10-11", "2018-10-16", "2018-10-21", "2018-10-26", "2018-10-31", "2018-11-05", "2018-11-10", "2018-11-15", "2018-11-20", "2018-11-25", "2018-11-30", "2018-12-05", "2018-12-10", "2018-12-15", "2018-12-20", "2018-12-25", "2018-12-30", "2019-01-04", "2019-01-09", "2019-01-14", "2019-01-19", "2019-01-24", "2019-01-29", "2019-02-03", "2019-02-08", "2019-02-13", "2019-02-18", "2019-02-23", "2019-02-28", "2019-03-05", "2019-03-10", "2019-03-15", "2019-03-20", "2019-03-25", "2019-03-30", "2019-04-04", "2019-04-09", "2019-04-14", "2019-04-19", "2019-04-24", "2019-04-29", "2019-05-04", "2019-05-09", "2019-05-14", "2019-05-19", "2019-05-24", "2019-05-29", "2019-06-03", "2019-06-08", "2019-06-13", "2019-06-18", "2019-06-23", "2019-06-28", "2019-07-03", "2019-07-08", "2019-07-13", "2019-07-18", "2019-07-23", "2019-07-28", "2019-08-02", "2019-08-07", "2019-08-12", "2019-08-17", "2019-08-22", "2019-08-27", "2019-09-01", "2019-09-06", "2019-09-11", "2019-09-16", "2019-09-21", "2019-09-26", "2019-10-01", "2019-10-06", "2019-10-11", "2019-10-16", "2019-10-21", "2019-10-26", "2019-10-31", "2019-11-05", "2019-11-10", "2019-11-15", "2019-11-20", "2019-11-25", "2019-11-30", "2019-12-05", "2019-12-10", "2019-12-15", "2019-12-20", "2019-12-25", "2019-12-30", "2020-01-04", "2020-01-09", "2020-01-14", "2020-01-19", "2020-01-24", "2020-01-29", "2020-02-03", "2020-02-08", "2020-02-13", "2020-02-18", "2020-02-23", "2020-02-28", "2020-03-04", "2020-03-09", "2020-03-14", "2020-03-19", "2020-03-24", "2020-03-29", "2020-04-03", "2020-04-08", "2020-04-13", "2020-04-18", "2020-04-23", "2020-04-28", "2020-05-03", "2020-05-08", "2020-05-13", "2020-05-18", "2020-05-23", "2020-05-28", "2020-06-02", "2020-06-07", "2020-06-12", "2020-06-17", "2020-06-22", "2020-06-27", "2020-07-02", "2020-07-07", "2020-07-12", "2020-07-17", "2020-07-22", "2020-07-27", "2020-08-01", "2020-08-06", "2020-08-11", "2020-08-16", "2020-08-21", "2020-08-26", "2020-08-31", "2020-09-05", "2020-09-10", "2020-09-15", "2020-09-20", "2020-09-25", "2020-09-30", "2020-10-05", "2020-10-10", "2020-10-15", "2020-10-20", "2020-10-25", "2020-10-30", "2020-11-04", "2020-11-09", "2020-11-14", "2020-11-19", "2020-11-24", "2020-11-29", "2020-12-04", "2020-12-09", "2020-12-14", "2020-12-19", "2020-12-24", "2020-12-29", "2021-01-03", "2021-01-08", "2021-01-13", "2021-01-18", "2021-01-23", "2021-01-28", "2021-02-02", "2021-02-07", "2021-02-12", "2021-02-17", "2021-02-22", "2021-02-27", "2021-03-04", "2021-03-09", "2021-03-14", "2021-03-19", "2021-03-24", "2021-03-29", "2021-04-03", "2021-04-08", "2021-04-13", "2021-04-18", "2021-04-23", "2021-04-28", "2021-05-03", "2021-05-08", "2021-05-13", "2021-05-18", "2021-05-23", "2021-05-28", "2021-06-02", "2021-06-07", "2021-06-12", "2021-06-17", "2021-06-22", "2021-06-27", "2021-07-02", "2021-07-07", "2021-07-12", "2021-07-17", "2021-07-22", "2021-07-27", "2021-08-01", "2021-08-06", "2021-08-11", "2021-08-16", "2021-08-21", "2021-08-26", "2021-08-31", "2021-09-05", "2021-09-10", "2021-09-15", "2021-09-20", "2021-09-25", "2021-09-30", "2021-10-05", "2021-10-10", "2021-10-15", "2021-10-20", "2021-10-25", "2021-10-30", "2021-11-04", "2021-11-09", "2021-11-14", "2021-11-19", "2021-11-24", "2021-11-29", "2021-12-04", "2021-12-09", "2021-12-14", "2021-12-19", "2021-12-24", "2021-12-29", "2022-01-03", "2022-01-08", "2022-01-13", "2022-01-18", "2022-01-23", "2022-01-28", "2022-02-02", "2022-02-07", "2022-02-12", "2022-02-17", "2022-02-22", "2022-02-27", "2022-03-04", "2022-03-09", "2022-03-14", "2022-03-19", "2022-03-24", "2022-03-29", "2022-04-03", "2022-04-08", "2022-04-13", "2022-04-18", "2022-04-23", "2022-04-28", "2022-05-03", "2022-05-08", "2022-05-13", "2022-05-18", "2022-05-23", "2022-05-28", "2022-06-02", "2022-06-07", "2022-06-12", "2022-06-17", "2022-06-22", "2022-06-27", "2022-07-02", "2022-07-07", "2022-07-12", "2022-07-17", "2022-07-22", "2022-07-27", "2022-08-01", "2022-08-06", "2022-08-11", "2022-08-16", "2022-08-21", "2022-08-26", "2022-08-31", "2022-09-05", "2022-09-10", "2022-09-15", "2022-09-20", "2022-09-25", "2022-09-30", "2022-10-05", "2022-10-10", "2022-10-15", "2022-10-20", "2022-10-25", "2022-10-30", "2022-11-04", "2022-11-09", "2022-11-14", "2022-11-19", "2022-11-24", "2022-11-29", "2022-12-04", "2022-12-09", "2022-12-14", "2022-12-19", "2022-12-24", "2022-12-29", "2023-01-03", "2023-01-08", "2023-01-13", "2023-01-18", "2023-01-23", "2023-01-28", "2023-02-02", "2023-02-07", "2023-02-12", "2023-02-17", "2023-02-22", "2023-02-27", "2023-03-04", "2023-03-09", "2023-03-14", "2023-03-19", "2023-03-24", "2023-03-29", "2023-04-03", "2023-04-08", "2023-04-13", "2023-04-18", "2023-04-23", "2023-04-28", "2023-05-03", "2023-05-08", "2023-05-13", "2023-05-18", "2023-05-23", "2023-05-28", "2023-06-02", "2023-06-07", "2023-06-12", "2023-06-17", "2023-06-22", "2023-06-27", "2023-07-02", "2023-07-07", "2023-07-12", "2023-07-17", "2023-07-22", "2023-07-27", "2023-08-01", "2023-08-06", "2023-08-11", "2023-08-16", "2023-08-21", "2023-08-26", "2023-08-31", "2023-09-05", "2023-09-10", "2023-09-15", "2023-09-20", "2023-09-25", "2023-09-30", "2023-10-05", "2023-10-10", "2023-10-15", "2023-10-20", "2023-10-25", "2023-10-30", "2023-11-04", "2023-11-09", "2023-11-14", "2023-11-19", "2023-11-24", "2023-11-29", "2023-12-04", "2023-12-09", "2023-12-14", "2023-12-19", "2023-12-24", "2023-12-29", "2024-01-03", "2024-01-08", "2024-01-13", "2024-01-18", "2024-01-23", "2024-01-28", "2024-02-02", "2024-02-07", "2024-02-12", "2024-02-17", "2024-02-22", "2024-02-27", "2024-03-03", "2024-03-08", "2024-03-13", "2024-03-18", "2024-03-23", "2024-03-28", "2024-04-02", "2024-04-07", "2024-04-12", "2024-04-17", "2024-04-22", "2024-04-27", "2024-05-02", "2024-05-07", "2024-05-12", "2024-05-17", "2024-05-22", "2024-05-27", "2024-06-01", "2024-06-06", "2024-06-11", "2024-06-16", "2024-06-21", "2024-06-26", "2024-07-01", "2024-07-06", "2024-07-11", "2024-07-16", "2024-07-21", "2024-07-26", "2024-07-31", "2024-08-05", "2024-08-10", "2024-08-15", "2024-08-20", "2024-08-25", "2024-08-30", "2024-09-04", "2024-09-09", "2024-09-14", "2024-09-19", "2024-09-24", "2024-09-29", "2024-10-04", "2024-10-09", "2024-10-14", "2024-10-19", "2024-10-24", "2024-10-29", "2024-11-03", "2024-11-08", "2024-11-13", "2024-11-18", "2024-11-23", "2024-11-28", "2024-12-03", "2024-12-08", "2024-12-13", "2024-12-18", "2024-12-23", "2024-12-28", "2025-01-02", "2025-01-07", "2025-01-12", "2025-01-17", "2025-01-22", "2025-01-27", "2025-02-01", "2025-02-06", "2025-02-11", "2025-02-16", "2025-02-21", "2025-02-26", "2025-03-03", "2025-03-08", "2025-03-13", "2025-03-18", "2025-03-23", "2025-03-28", "2025-04-02", "2025-04-07", "2025-04-12", "2025-04-17", "2025-04-22", "2025-04-27", "2025-05-02", "2025-05-07", "2025-05-12", "2025-05-17", "2025-05-22", "2025-05-27", "2025-06-01", "2025-06-06", "2025-06-11", "2025-06-16", "2025-06-21", "2025-06-26", "2025-07-01", "2025-07-06", "2025-07-11", "2025-07-16", "2025-07-21", "2025-07-26", "2025-07-31", "2025-08-05", "2025-08-10", "2025-08-15", "2025-08-20", "2025-08-25", "2025-08-30", "2025-09-04", "2025-09-09", "2025-09-14", "2025-09-19", "2025-09-24", "2025-09-29", "2025-10-04", "2025-10-09", "2025-10-14", "2025-10-19", "2025-10-24", "2025-10-29", "2025-11-03", "2025-11-08", "2025-11-13", "2025-11-18", "2025-11-23", "2025-11-28", "2025-12-03", "2025-12-08", "2025-12-13", "2025-12-18", "2025-12-23", "2025-12-28", "2026-01-02", "2026-01-07", "2026-01-12", "2026-01-17", "2026-01-22", "2026-01-27", "2026-02-01", "2026-02-06", "2026-02-11", "2026-02-16", "2026-02-21", "2026-02-26"];

const SCATTER_CAGR = [3.7, 5.6, 7.4, 9.3, 11.2, 13.1, 15.0, 16.9, 18.9, 20.8];
const SCATTER_MDD  = [1.99, 2.97, 3.95, 4.93, 5.92, 6.91, 7.9, 8.89, 9.88, 10.87];
const SCATTER_RISK = [0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0, 2.25, 2.5, 2.75];
const SCATTER_SH   = [1.018, 1.018, 1.018, 1.018, 1.018, 1.018, 1.018, 1.018, 1.018, 1.018];

// Profile data
const PROFILES = {
  cons: { eq:CONS_EQ, dd:CONS_DD, color:'#4f8ef7',
    kpis:['2.08','52.1%','+0.504R',
          '+7.4%','1.018','1.245','-4.0%'],
    kpi_ok:[true,true,true,false,true,true,true] },
  bal:  { eq:BAL_EQ,  dd:BAL_DD,  color:'#f7c948',
    kpis:['2.08','52.1%','+0.504R',
          '+13.5%','1.018','1.245','-7.1%'],
    kpi_ok:[true,true,true,true,true,true,true] },
  agg:  { eq:AGG_EQ,  dd:AGG_DD,  color:'#00d4aa',
    kpis:['2.08','52.1%','+0.504R',
          '+18.9%','1.018','1.245','-9.9%'],
    kpi_ok:[true,true,true,true,true,true,true] }
};

const KPI_LABELS = ['Profit Factor','Win Rate','E[R]','CAGR','Sharpe','Sortino','Max DD'];
const KPI_TGTS   = ['1.25–2.0','35–60%','>+0.15R','>8%','0.6–1.2','>1.0','5–20%'];
let currentProfile = 'cons';

// ── EQUITY CHART ──────────────────────────────────────────────────────────
const eqCtx = document.getElementById('eqC').getContext('2d');
const eqChart = new Chart(eqCtx, {
  type:'line',
  data:{ labels:DAYS, datasets:[
    { label:'Conservativo', data:CONS_EQ, borderColor:'#4f8ef7', borderWidth:1.5,
       pointRadius:0, fill:false, tension:.4 },
    { label:'Bilanciato',   data:BAL_EQ,  borderColor:'#f7c948', borderWidth:2,
       pointRadius:0, fill:false, tension:.4 },
    { label:'Aggressivo',   data:AGG_EQ,  borderColor:'#00d4aa', borderWidth:2,
       pointRadius:0, fill:false, tension:.4 },
  ]},
  options:{responsive:true,maintainAspectRatio:true,
    plugins:{
      legend:{display:true,position:'top',labels:{boxWidth:12,padding:16}},
      tooltip:{mode:'index',intersect:false,callbacks:{label:c=>c.dataset.label+': '+c.parsed.y.toFixed(1)}}
    },
    scales:{
      x:{grid:{color:'rgba(255,255,255,.025)'},ticks:{maxTicksLimit:8}},
      y:{grid:{color:'rgba(255,255,255,.025)'},ticks:{callback:v=>v.toFixed(0)}}
    }
  }
});

// ── DD CHART ──────────────────────────────────────────────────────────────
const ddCtx = document.getElementById('ddC').getContext('2d');
const ddChart = new Chart(ddCtx, {
  type:'line',
  data:{ labels:DAYS, datasets:[{
    data:CONS_DD, borderColor:'#4f8ef7', borderWidth:1.5, pointRadius:0,
    fill:true, tension:.3,
    backgroundColor:(ctx)=>{ const g=ctx.chart.ctx.createLinearGradient(0,0,0,180);
      g.addColorStop(0,'rgba(79,142,247,0)'); g.addColorStop(1,'rgba(79,142,247,.2)'); return g; }
  }]},
  options:{responsive:true,maintainAspectRatio:true,
    plugins:{legend:{display:false},tooltip:{callbacks:{label:c=>c.parsed.y.toFixed(2)+'%'}}},
    scales:{
      x:{grid:{color:'rgba(255,255,255,.025)'},ticks:{maxTicksLimit:6}},
      y:{grid:{color:'rgba(255,255,255,.025)'},ticks:{callback:v=>v.toFixed(1)+'%'}}
    }
  }
});

// ── SCATTER ───────────────────────────────────────────────────────────────
const scCtx = document.getElementById('scC').getContext('2d');
const markers = SCATTER_RISK.map((r,i)=>{
  let c='rgba(0,212,170,.7)';
  if(r<=1.0) c='rgba(79,142,247,.8)';
  else if(r<=1.8) c='rgba(247,201,72,.8)';
  return { x:SCATTER_MDD[i], y:SCATTER_CAGR[i], r:6, label:`TF ${r}%`, color:c };
});
new Chart(scCtx, {
  type:'bubble',
  data:{ datasets:[{ data:markers,
    backgroundColor: markers.map(m=>m.color),
    borderColor: markers.map(m=>m.color.replace('0.7','1').replace('0.8','1')),
    borderWidth:1.5 }]},
  options:{responsive:true,maintainAspectRatio:true,
    plugins:{legend:{display:false},
      tooltip:{callbacks:{label:d=>`TF ${SCATTER_RISK[d.dataIndex]}% → CAGR +${d.parsed.y}%  MDD -${d.parsed.x.toFixed(1)}%`}}},
    scales:{
      x:{title:{display:true,text:'Max DD %',color:'#5a6480'},
          grid:{color:'rgba(255,255,255,.025)'},
          ticks:{callback:v=>'-'+v.toFixed(0)+'%'}},
      y:{title:{display:true,text:'CAGR %',color:'#5a6480'},
          grid:{color:'rgba(255,255,255,.025)'},
          ticks:{callback:v=>'+'+v.toFixed(0)+'%'}}
    }
  }
});

// ── EFFICIENT FRONTIER CHART ──────────────────────────────────────────────
const frontCtx = document.getElementById('frontC').getContext('2d');
const frontChart = new Chart(frontCtx, {
  type:'line',
  data:{ labels: SCATTER_MDD.map(v=>'-'+v.toFixed(1)+'%'),
    datasets:[{ label:'Frontiera CAGR/DD', data:SCATTER_CAGR,
      borderColor:'#00d4aa', borderWidth:2, pointRadius:4,
      pointBackgroundColor: SCATTER_RISK.map(r=>r<=1.0?'#4f8ef7':r<=1.8?'#f7c948':'#00d4aa'),
      fill:true, tension:.3,
      backgroundColor:(ctx)=>{ const g=ctx.chart.ctx.createLinearGradient(0,0,0,160);
        g.addColorStop(0,'rgba(0,212,170,.12)');g.addColorStop(1,'rgba(0,212,170,0)');return g; }
    }]},
  options:{responsive:true,maintainAspectRatio:true,
    plugins:{legend:{display:false},tooltip:{
      callbacks:{label:c=>`+${c.parsed.y.toFixed(1)}% CAGR @ -${SCATTER_MDD[c.dataIndex].toFixed(1)}% MDD`}
    }},
    scales:{
      x:{grid:{color:'rgba(255,255,255,.025)'},ticks:{maxTicksLimit:8}},
      y:{grid:{color:'rgba(255,255,255,.025)'},ticks:{callback:v=>'+'+v.toFixed(0)+'%'}}
    }
  }
});

// ── PROFILE SWITCH ───────────────────────────────────────────────────────
function setProfile(p){
  currentProfile = p;
  ['cons','bal','agg'].forEach(k=>{
    document.getElementById('tab-'+k).classList.toggle('active',k===p);
  });
  const pr = PROFILES[p];
  // Update KPIs
  const kpiEl = document.getElementById('kpi-row');
  kpiEl.innerHTML = KPI_LABELS.map((l,i)=>{
    const ok = pr.kpi_ok[i];
    return `<div class="kpi ${ok?'ok':'warn'}">
      <div class="kpi-l">${l}</div>
      <div class="kpi-v">${pr.kpis[i]}</div>
      <div class="kpi-t">target ${KPI_TGTS[i]}</div></div>`;
  }).join('');
  // Update DD chart
  ddChart.data.datasets[0].data = pr.dd;
  ddChart.data.datasets[0].borderColor = pr.color;
  ddChart.update();
}

// ── SIMULATOR ────────────────────────────────────────────────────────────
// Linear interpolation from scatter data
function interpolate(riskVal){
  // Find two nearest scatter points
  let lo=0, hi=SCATTER_RISK.length-1;
  for(let i=0;i<SCATTER_RISK.length;i++){
    if(SCATTER_RISK[i]<=riskVal) lo=i;
    if(SCATTER_RISK[i]>=riskVal && SCATTER_RISK[lo]<=riskVal){hi=i;break;}
  }
  if(lo===hi) return {cagr:SCATTER_CAGR[lo],mdd:SCATTER_MDD[lo],sh:SCATTER_SH[lo]};
  const t=(riskVal-SCATTER_RISK[lo])/(SCATTER_RISK[hi]-SCATTER_RISK[lo]);
  return {
    cagr: SCATTER_CAGR[lo]+(SCATTER_CAGR[hi]-SCATTER_CAGR[lo])*t,
    mdd:  SCATTER_MDD[lo]+(SCATTER_MDD[hi]-SCATTER_MDD[lo])*t,
    sh:   SCATTER_SH[lo]+(SCATTER_SH[hi]-SCATTER_SH[lo])*t,
  };
}

function updateSim(v){
  const risk = parseFloat(v);
  document.getElementById('slVal').textContent = risk.toFixed(2)+'%';
  const r = interpolate(risk);
  document.getElementById('sv-cagr').textContent = '+'+r.cagr.toFixed(1)+'%';
  document.getElementById('sv-mdd').textContent  = '-'+r.mdd.toFixed(1)+'%';
  document.getElementById('sv-sh').textContent   = r.sh.toFixed(3);
  document.getElementById('sv-cp').textContent   = (risk*0.5).toFixed(3)+'%';
  const ddOk = r.mdd<=20;
  document.getElementById('sim-mdd').className = 'kpi '+(ddOk?'ok':'warn');
  // Highlight current point on frontier chart
  const pts = SCATTER_RISK.map((r_,i)=>{
    const dist=Math.abs(r_-risk);
    return dist<0.15 ? 8 : 4;
  });
  frontChart.data.datasets[0].pointRadius = pts;
  frontChart.update('none');
}
updateSim(1.8);
</script>
</body>
</html>